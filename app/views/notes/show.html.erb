<% content_for :title, sanitize(@note.title) %>

<div class="max-w-screen-lg mx-auto text-gray-800 dark:text-white space-y-3">
  <div class="px-4 pt-4">
    <h1 class="font-bold text-xl mb-2"><%= @note.title %></h1>
    <%= render 'notes/components/note_meta', note: @note %>
  </div>

  <div class="mb-4 border-b border-gray-200 dark:border-gray-700">
    <ul class="flex flex-wrap -mb-px text-sm font-medium text-center justify-between md:justify-start px-4">
      <li class="mr-1">
        <%= link_to note_path(@note, tab: 'transcription'), 
            class: "inline-flex items-center justify-center p-2 md:p-4 border-b-2 rounded-t-lg #{@current_tab == 'transcription' ? 'text-green-600 border-green-600 dark:text-green-500 dark:border-green-500' : 'border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300'}" do %>
          <svg class="w-4 h-4 mr-1 md:mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
          </svg>
          <span class="">Transcription</span>
        <% end %>
      </li>
      <li class="mr-1">
        <%= link_to note_path(@note, tab: 'summary'), 
            class: "inline-flex items-center justify-center p-2 md:p-4 border-b-2 rounded-t-lg #{@current_tab == 'summary' ? 'text-green-600 border-green-600 dark:text-green-500 dark:border-green-500' : 'border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300'}" do %>
          <svg class="w-4 h-4 mr-1 md:mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" />
          </svg>
          <span class="">Summary</span>
        <% end %>
      </li>
      <li>
        <%= link_to note_path(@note, tab: 'chat'), 
            class: "inline-flex items-center justify-center p-2 md:p-4 border-b-2 rounded-t-lg #{@current_tab == 'chat' ? 'text-green-600 border-green-600 dark:text-green-500 dark:border-green-500' : 'border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300'}" do %>
          <svg class="w-4 h-4 mr-1 md:mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 0 1 .865-.501 48.172 48.172 0 0 0 3.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" />
          </svg>
          <span class="">Chat</span>
        <% end %>
      </li>
    </ul>
  </div>

  <div class="tab-content">
    <% case @current_tab %>
    <% when 'transcription' %>
      <div class="text-sm px-4 text-justify">
        <%= sanitize(@note.transcription) %>
      </div>
    <% when 'summary' %>
      <% if @note.summary.present? %>
        <div class="text-sm px-4 text-justify">
          <%= sanitize(@note.summary) %>
        </div>
      <% else %>
        <div class="text-center py-10">
          <p class="text-gray-500 dark:text-gray-400">No summary available yet.</p>
        </div>
      <% end %>
    <% when 'chat' %>
      <%= render 'notes/components/note_chat', note: @note %>
    <% end %>
  </div>
</div>